<% layout("layouts/bolierplate.ejs") %>

<div class="container mt-4">

    <div class="email-container">

        <h2 class="mb-4 fw-bold">Urgent Draft Messages</h2>

        <% if (drafts.length === 0) { %>

            <div class="alert alert-info text-center py-3">
                No urgent drafts available.
            </div>

        <% } else { %>

            <% drafts.forEach(draft => { %>

                <div class="card shadow-sm border-0 mb-3 rounded-4">

                    <div class="card-body">

                        <!-- TOP ROW: Badges + Title-->
                        <div class="d-flex justify-content-between align-items-start">

                            <div class="d-flex align-items-center gap-2">

                                <!-- Draft Badge -->
                                <span class="badge rounded-pill text-bg-danger px-3 py-2">
                                    Draft
                                </span>

                                <!-- Status Badge -->
                                <% if (draft.status === "pending") { %>
                                    <span class="badge rounded-pill text-bg-warning px-3 py-2">
                                        Pending
                                    </span>
                                <% } else if (draft.status === "edited") { %>
                                    <span class="badge rounded-pill text-bg-primary px-3 py-2">
                                        Edited
                                    </span>
                                <% } %>

                            </div>

                        </div>

                        <!-- BODY TEXT -->
                        <p class="card-text text-secondary mt-3">
                            <%= draft.draftBody.length > 120 
                                ? draft.draftBody.substring(0, 120) + "..."
                                : draft.draftBody 
                            %>
                        </p>

                        <!-- BUTTONS -->
                        <div class="mt-3 d-flex gap-3">

                            <a href="/draft/<%= draft._id %>" 
                               class="btn btn-outline-primary btn-sm rounded-3 px-3">
                                View
                            </a>

                            <form action="/draft/<%= draft._id %>?_method=DELETE" method="POST">
                                <button type="submit" 
                                        class="btn btn-outline-danger btn-sm rounded-3 px-3">
                                    Delete
                                </button>
                            </form>

                        </div>

                    </div>

                </div>

            <% }) %>

        <% } %>

    </div>

</div>
